<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ’– Best Friend Special ğŸ’–</title>
<style>
body {
  font-family: 'Comic Sans MS', cursive, sans-serif;
  background: url('background.jpg') no-repeat center center fixed;
  background-size: cover;
  color: #ffb6c1;
  text-align: center;
  padding: 50px;
}
h1 { font-size: 3em; text-shadow: 2px 2px 5px darkred; }
button { background-color: #ff69b4; color: white; border: none; padding: 10px 20px; margin:10px; border-radius: 8px; cursor:pointer; font-weight:bold;}
.input-section, .photo-section, .final-section, .surprise-section { 
  background-color: rgba(255,182,193,0.8); padding:20px; border-radius:15px; display:none; margin:20px auto; max-width:500px; 
}
.photo-section img, .surprise-section img { width:250px; border:4px solid #ff69b4; border-radius:15px; margin:10px; }
.message-card { background-color: rgba(255,105,180,0.3); padding:15px; margin:10px auto; max-width:400px; border-radius:15px; text-align:left; }
audio { margin-top:10px; }
textarea { width: 90%; border-radius:8px; padding:5px; }
input[type="file"] { margin-top:10px; }
.countdown { font-size: 1.5em; margin-top:20px; text-shadow:1px 1px 3px darkred; color: #fff; }
</style>
</head>
<body>

<h1>ğŸ’– You're My Special Best Friend! ğŸ’–</h1>

<!-- Page 1: Password + Countdown -->
<div class="input-section" id="page1">
  <h2>Enter Password to Continue ğŸ’Œ</h2>
  <input type="text" id="passwordInput" placeholder="Hint: My Birthday">
  <button id="passwordBtn">Submit ğŸ”‘</button>
  <p class="countdown" id="countdown"></p>
</div>

<!-- Page 2: Favorite Photo + Music -->
<div class="photo-section" id="page2">
  <h2>Our Favorite Photo ğŸ¥°</h2>
  <img src="photo1.jpg" alt="Favorite Photo">
  <h3>Play Our Song ğŸµ</h3>
  <button id="playMusicBtn">Play Music â–¶ï¸</button>
  <audio id="bgMusic" src="https://www.youtube.com/shorts/DHx216vYILM?si=JCbQGQ--tr"></audio><br>
  <button id="nextToQuestions">Next â¡ï¸</button>
  <button onclick="goBack(1)">Back â¬…ï¸</button>
</div>

<!-- Page 3: Questions + Upload -->
<div class="final-section" id="page3">
  <h2>Answer Questions & Share Memories ğŸ’–</h2>
  <p>Do you love me? â¤ï¸</p>
  <input type="text" id="loveInput" placeholder="Yes or No"><br>
  <p>Most special moment with me? ğŸ¥°</p>
  <input type="text" id="specialMoment" placeholder="Write your answer"><br>

  <h3>Upload Photos or Voice Notes ğŸ“¸ğŸ¤</h3>
  <input type="file" id="photoUpload" accept="image/*"><br>
  <button id="recordBtn">Record Voice Note ğŸ¤</button>
  <audio id="audioPlayback" controls style="display:none;"></audio><br>

  <button id="submitMemory">Submit Memory ğŸ’Œ</button>
  <div id="messagesContainer"></div>
  <button id="showSurprise">Surprise! ğŸ‰</button>
  <button onclick="goBack(2)">Back â¬…ï¸</button>
</div>

<!-- Page 4: Surprise -->
<div class="surprise-section" id="page4">
  <h2>ğŸ’– You Have a Surprise! ğŸ¥°</h2>
  <img src="surprise.PNG" alt="Surprise Photo">
  <p id="surpriseMessage" style="font-size:1.2em; color:#fff; text-shadow:1px 1px 2px darkred;">
    ğŸ’Œ Hey bestie! I just wanted to sayâ€¦ you are the most special person in my life! ğŸ’–ğŸ¥°
  </p>
  <button onclick="goBack(3)">Back â¬…ï¸</button>
</div>

<script>
// Pages
const page1 = document.getElementById('page1');
const page2 = document.getElementById('page2');
const page3 = document.getElementById('page3');
const page4 = document.getElementById('page4');

// Password
const passwordBtn = document.getElementById('passwordBtn');
const passwordInput = document.getElementById('passwordInput');
passwordBtn.addEventListener('click', () => {
  if(passwordInput.value === "14122005"){
    page1.style.display="none";
    page2.style.display="block";
  } else {
    alert("âŒ Wrong password! Hint: My Birthday");
  }
});

// Countdown to Aug 21, 2024
function updateCountdown(){
  const birthday = new Date("August 21, 2024 00:00:00").getTime();
  const now = new Date().getTime();
  const distance = birthday - now;
  const countdown = document.getElementById('countdown');
  if(distance<=0){
    countdown.textContent = "ğŸ‰ It's Time! Enter Password ğŸ’–";
  } else {
    const days=Math.floor(distance/(1000*60*60*24));
    const hours=Math.floor((distance%(1000*60*60*24))/(1000*60*60));
    const minutes=Math.floor((distance%(1000*60*60))/(1000*60));
    const seconds=Math.floor((distance%(1000*60))/1000);
    countdown.textContent=`Countdown to Aug 21, 2024: ${days}d ${hours}h ${minutes}m ${seconds}s`;
  }
}
setInterval(updateCountdown,1000);

// Page Navigation
function goBack(page){
  page1.style.display = "none";
  page2.style.display = "none";
  page3.style.display = "none";
  page4.style.display = "none";
  if(page===1) page1.style.display="block";
  if(page===2) page2.style.display="block";
  if(page===3) page3.style.display="block";
  if(page===4) page4.style.display="block";
}
document.getElementById('nextToQuestions').addEventListener('click',()=>{
  page2.style.display="none";
  page3.style.display="block";
});

// Play Music
const playMusicBtn = document.getElementById('playMusicBtn');
const bgMusic = document.getElementById('bgMusic');
playMusicBtn.addEventListener('click',()=>{
  if(bgMusic.paused) bgMusic.play();
  else bgMusic.pause();
});

// Voice Recording
let audioBlob;
let mediaRecorder;
const recordBtn = document.getElementById('recordBtn');
const audioPlayback = document.getElementById('audioPlayback');
recordBtn.addEventListener('click',async()=>{
  if(mediaRecorder && mediaRecorder.state==='recording'){
    mediaRecorder.stop();
    recordBtn.textContent='Record Voice Note ğŸ¤';
  } else {
    const stream = await navigator.mediaDevices.getUserMedia({audio:true});
    mediaRecorder = new MediaRecorder(stream);
    const chunks=[];
    mediaRecorder.ondataavailable = e => chunks.push(e.data);
    mediaRecorder.onstop = ()=>{
      audioBlob=new Blob(chunks,{type:'audio/ogg; codecs=opus'});
      audioPlayback.src=URL.createObjectURL(audioBlob);
      audioPlayback.style.display='block';
    };
    mediaRecorder.start();
    recordBtn.textContent='Stop Recording â¹ï¸';
  }
});

// Submit Memory to SheetDB
document.getElementById('submitMemory').addEventListener('click', async()=>{
  const love=document.getElementById('loveInput').value;
  const moment=document.getElementById('specialMoment').value;
  const photoInput=document.getElementById('photoUpload').files[0];

  let photoURL='';
  if(photoInput){
    const formData=new FormData();
    formData.append('image',photoInput);
    const res=await fetch('https://api.imgur.com/3/image',{
      method:'POST',
      headers:{ Authorization: 'Client-ID YOUR_IMGUR_CLIENT_ID' },
      body: formData
    });
    const data=await res.json();
    photoURL=data.data.link;
  }

  let audioURL='';
  if(audioBlob){
    const formData=new FormData();
    formData.append('file',audioBlob,'voice.ogg');
    const res=await fetch('https://file.io',{method:'POST',body:formData});
    const data=await res.json();
    audioURL=data.link;
  }

  const photoDisplay = photoURL ? `=IMAGE("${photoURL}")` : '';

  await fetch('https://sheetdb.io/api/v1/klia6jc7w0l07',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({data:{loveAnswer:love,moment:moment,photoURL:photoURL,photoDisplay:photoDisplay,audioURL:audioURL,timestamp:new Date().toLocaleString()}})
  });

  const container=document.getElementById('messagesContainer');
  const card=document.createElement('div'); card.className='message-card';
  if(photoURL){ const img=document.createElement('img'); img.src=photoURL; card.appendChild(img); }
  if(audioURL){ const audio=document.createElement('audio'); audio.controls=true; audio.src=audioURL; card.appendChild(audio); }
  const p=document.createElement('p'); p.textContent=`Do you love me: ${love}, Special Moment: ${moment}`; card.appendChild(p);
  container.appendChild(card);

  document.getElementById('loveInput').value='';
  document.getElementById('specialMoment').value='';
  document.getElementById('photoUpload').value='';
  audioPlayback.style.display='none'; audioBlob=null;
});

// Show Surprise
document.getElementById('showSurprise').addEventListener('click',()=>{
  page3.style.display="none";
  page4.style.display="block";
});
</script>
</body>
</html>
